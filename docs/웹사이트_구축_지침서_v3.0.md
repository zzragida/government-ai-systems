# 오픈해시 정부 AI 시스템 웹사이트 구축 지침서 v3.0

**작성일**: 2025-11-29  
**서버**: AWS EC2 (IP: 100.30.14.224)  
**포털**: http://100.30.14.224/

---

## ⚠️ 최우선 원칙

### Claude 작업 환경
- Claude는 AWS EC2 서버에 직접 접근 불가
- 사용자가 SSH로 명령어를 복사하여 실행
- 모든 파일 생성은 bash 명령어를 텍스트로 제시

### 절대 금지 사항
- ❌ Claude 내부 도구(create_file, bash_tool)로 파일 직접 생성
- ❌ /mnt/user-data/outputs/, /home/claude/ 경로 사용
- ❌ computer:// 다운로드 링크 제공

### 올바른 방법
- ✅ cat > 파일경로 << 'DELIM' 형식으로 제시
- ✅ 파일은 /var/www/government-ai-systems/ 하위에 생성
- ✅ 여러 파일을 한 번의 bash 코드블록으로 제출

---

## 1. 서버 환경

| 항목 | 값 |
|------|-----|
| 서버 IP | 100.30.14.224 |
| 내부 IP | 172.31.80.184 |
| 운영체제 | Ubuntu 24.04 |
| 웹서버 | Nginx 1.24.0 |
| 백엔드 | Python 3.12.3 (Flask) |
| 프론트엔드 | React 18 (Babel standalone) + Tailwind CSS |

---

## 2. 현재 시스템 목록 (22개)

| ID | 이름 | 포트 | 카테고리 |
|----|------|------|----------|
| openhash-system | 오픈해시 기술 | 5037 | tech |
| private-data-vault | 프라이빗 데이터 금고 | 5025 | tech |
| national-data-registry | 국가데이터처 | 5026 | tech |
| currency | 디지털 화폐 | 5001 | finance |
| education | 교육부 | 5003 | education |
| food-drug-safety | 식약처 | 5006 | welfare |
| healthcare | 의료 통합 | 5005 | welfare |
| jeju-hospital | OpenHash 의료 자동화 | 5007 | jeju |
| jeju-integrated | 제주 통합 | 5008 | jeju |
| judicial | 예방적 사법 | 5010 | legal |
| k12 | K-12 교육 | 5011 | education |
| lawsuit | AI 전자소송 | 5012 | legal |
| legislation | 법제처 | 5013 | legal |
| local-admin | 통합 자치행정 | 5014 | admin |
| market | FPGA 시장 | 5015 | finance |
| intellectual-property | 지식재산권 | 5016 | legal |
| meal | 국가 급식 | 5017 | welfare |
| patents | 특허 AI | 5018 | legal |
| personnel-innovation | 인사혁신 | 5019 | admin |
| tax | 국세 행정 | 5020 | finance |
| traffic | 지능형 교통 | 5021 | infra |
| university | 대학교육 | 5022 | education |

사용 가능한 포트: 5002, 5004, 5009, 5023, 5024, 5027~5036, 5038 이상

---

## 3. 새 시스템 추가 절차

### 3.1 변수 설정
NEW_SYSTEM="new-system-id"
NEW_PORT=5027
NEW_NAME="새 시스템 이름"

### 3.2 디렉토리 생성
sudo mkdir -p /var/www/government-ai-systems/${NEW_SYSTEM}/{backend,js/components}
sudo chown -R ubuntu:ubuntu /var/www/government-ai-systems/${NEW_SYSTEM}/

### 3.3 Nginx 설정 추가
location /NEW_SYSTEM_ID/ { alias /var/www/government-ai-systems/NEW_SYSTEM_ID/; }
location /api/NEW_SYSTEM_ID/ { proxy_pass http://127.0.0.1:NEW_PORT/; }
sudo nginx -t && sudo systemctl reload nginx

### 3.4 백엔드 시작
cd /var/www/government-ai-systems/${NEW_SYSTEM}/backend
nohup python3 server.py > /dev/null 2>&1 &

---

## 4. 의료 시스템 구축 가이드

### 4.1 개요

jeju-hospital 시스템은 OpenHash 기반의 의료 자동화 플랫폼:

- OpenHash 기술 중심: 모든 의료 데이터의 무결성 및 진실성 보장
- 실시간 시뮬레이션: 의료 현황, 생체 데이터, 진료 예약 실시간 갱신
- AI 통합: Claude API 연동 AI 의사/간호사 상담
- 환자 중심 설계: 개인정보금고(PDV)로 환자 데이터 주권 보장

### 4.2 메뉴 구성 (9개 + 1)

| 메뉴 | 컴포넌트 | 설명 | 배지 |
|------|----------|------|------|
| 대시보드 | Dashboard.js | 메인 화면 | - |
| 의료 현황 | MedicalStatus.js | 47개 병원, 의료진, 장비 | LIVE |
| 생체감지 워치 | SmartWatchMonitor.js | 5명 환자 모니터링 | NEW |
| AI 의사 상담 | AIDoctorChat.js | Claude API 연동 | - |
| AI 간호사 | AINurseChat.js | 간호 업무 시뮬레이션 | - |
| 생체 모니터 | VitalMonitor.js | 심박, 혈압 모니터링 | - |
| 개인정보금고 | PDVManager.js | 의료정보 열람 (AES-256) | - |
| 진료 예약 | Appointment.js | 6개 시설 41개 진료과 | - |
| 병원 정보 | HospitalInfo.js | 의료진, 장비, 평가 | - |
| OpenHash | OpenHashInfo.js | 좌측 하단 클릭 | 검증됨 |

### 4.3 핵심 컴포넌트 패턴

#### 실시간 시뮬레이션 (5초 간격)
React.useEffect(() => {
    const interval = setInterval(() => {
        setData(prev => ({ ...prev, value: newValue }));
    }, 5000);
    return () => clearInterval(interval);
}, []);

#### 스마트워치 화면 순환
const screens = ['vitals', 'activity', 'health', 'alerts'];
setScreenIndex(prev => (prev + 1) % 4);

#### PDV 잠금/해제 패턴
if (!isUnlocked) return <LockScreen />;
return <TabContent activeTab={activeTab} />;

### 4.4 OpenHash 통합 패턴

- 사이트 제목: "OpenHash 기반 의료 자동화 시스템"
- 로고: fa-link (cyan-400 색상)
- 헤더에 검증 배지: "OpenHash 검증됨" + 녹색 펄스

### 4.5 상태 표시 색상 규칙

| 상태 | 배경색 | 텍스트색 |
|------|--------|----------|
| 정상 | green-500/20 | green-400 |
| 주의 | yellow-500/20 | yellow-400 |
| 위험 | red-500/20 | red-400 |
| 완료 | green-500/20 | green-400 |
| 진행중 | blue-500/20 | blue-400 |
| 대기 | gray-500/20 | gray-400 |

---

## 5. 유틸리티 스크립트

### 백엔드 일괄 시작
pkill -f "python3.*app.py"
pkill -f "python3.*server.py"
# server.py 백엔드
for dir in openhash-system private-data-vault national-data-registry education food-drug-safety jeju-hospital judicial k12; do
    cd /var/www/government-ai-systems/$dir/backend
    nohup python3 server.py > /dev/null 2>&1 &
done
# app.py 백엔드
for dir in currency healthcare jeju-integrated lawsuit legislation local-admin market intellectual-property meal patents personnel-innovation tax traffic university; do
    cd /var/www/government-ai-systems/$dir/backend
    nohup python3 app.py > /dev/null 2>&1 &
done

### 전체 헬스체크
for id in openhash-system private-data-vault ...; do
    status=$(curl -s -o /dev/null -w "%{http_code}" http://localhost/api/$id/health)
    echo "$id: $status"
done

---

## 6. GitHub 업로드

cd /var/www/government-ai-systems
git add -A
git commit -m "커밋 메시지"
git push origin main

---

## 7. 문제 해결

### 백엔드 502 에러
netstat -tlnp | grep 포트번호
pkill -f "server.py"
nohup python3 server.py > /dev/null 2>&1 &

### Nginx 설정 오류
sudo nginx -t
sudo tail -20 /var/log/nginx/error.log

---

## 8. 의료 시스템 체크리스트

### 신규 구축 시
- [ ] OpenHash 브랜딩 적용
- [ ] 실시간 시뮬레이션 구현 (5초 간격)
- [ ] 환자/의료시설 데이터 구조 설계
- [ ] PDV 잠금 해제 UI
- [ ] 상태 색상 규칙 적용
- [ ] 플로팅 AI 상담 버튼
- [ ] OpenHash 상세 페이지 연결

### 컴포넌트 개발 시
- [ ] React 함수형 컴포넌트 + Hooks
- [ ] useEffect로 실시간 데이터 갱신
- [ ] Tailwind CSS 그라데이션 및 애니메이션

---

## 9. 컴포넌트 코드 크기 참고

| 컴포넌트 | 라인 | 주요 기능 |
|----------|------|-----------|
| MedicalStatus.js | ~600 | 5개 탭, 19개 진료과 |
| SmartWatchMonitor.js | ~400 | 5개 워치, 4개 화면 |
| PDVManager.js | ~700 | 7개 탭, 차트 |
| OpenHashInfo.js | ~500 | 4개 섹션 |
| FloatingAssistant.js | ~250 | AI 채팅 |

---

문서 버전: v3.0
최종 수정: 2025-11-29

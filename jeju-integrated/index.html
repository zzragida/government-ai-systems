<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제주 AI 포털</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #0066FF;
            --secondary-blue: #0052CC;
            --gray-50: #F9FAFB;
            --gray-700: #374151;
            --gray-800: #1F2937;
        }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--gray-50);
            margin: 0;
            padding: 0;
        }
        .notice-banner {
            background: var(--gray-800);
            border-bottom: 1px solid var(--gray-700);
            padding: 0.375rem 0;
        }
        .gov-banner {
            background: linear-gradient(135deg, #0047B3 0%, #003D99 100%);
            color: white;
            padding: 0.75rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tab-nav {
            background: white;
            border-bottom: 2px solid #F3F4F6;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .tab-button {
            padding: 1rem 2rem;
            text-decoration: none;
            display: inline-block;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            color: var(--gray-700);
            font-weight: 500;
            font-size: 16px;
            cursor: pointer;
            background: none;
            border-top: none;
            border-left: none;
            border-right: none;
        }
        .tab-button:hover {
            color: var(--primary-blue);
            background-color: #E6F0FF;
        }
        .tab-button.active {
            color: var(--primary-blue);
            border-bottom-color: var(--primary-blue);
            font-weight: 600;
        }
        .btn {
            padding: 0.375rem 0.75rem;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            font-size: 13px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            border: none;
        }
        .btn-white {
            background: white;
            color: var(--gray-800);
            border: 1px solid white;
        }
        .btn-white:hover {
            background: #F3F4F6;
        }
        #content-container {
            min-height: 600px;
        }
        .loading {
            text-align: center;
            padding: 3rem;
            color: #6B7280;
        }
    </style>
</head>
<body>
    <!-- 안내 배너 -->
    <div class="notice-banner">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-2 text-xs text-white">
                    <span>⚠️</span>
                    <span>본 사이트는 오픈해시 실증 및 테스트용이며, 정부 공식 사이트가 아닙니다.</span>
                </div>
                <div class="flex items-center gap-2">
                    <a href="http://100.30.14.224/openhash-system/" class="btn btn-white">오픈해시 ❓</a>
                    <a href="http://100.30.14.224/portal/" class="btn btn-white">포털</a>
                    <button onclick="handleAuth()" class="btn btn-white" id="authBtn">로그인</button>
                    <span id="userInfo" class="text-xs text-white" style="display: none;"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- 정부 공식 배너 -->
    <header class="gov-banner">
        <div class="max-w-7xl mx-auto px-4">
            <h1 class="text-base font-bold">우리 사회의 모든 것을 Openhash와 AI로 재구성합니다.</h1>
        </div>
    </header>

    <!-- 탭 네비게이션 -->
    <nav class="tab-nav">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex space-x-1">
                <button class="tab-button active" data-tab="tab1" onclick="loadTab('tab1')">정부</button>
                <button class="tab-button" data-tab="tab2" onclick="loadTab('tab2')">의료</button>
                <button class="tab-button" data-tab="tab3" onclick="loadTab('tab3')">탭3</button>
                <button class="tab-button" data-tab="tab4" onclick="loadTab('tab4')">탭4</button>
                <button class="tab-button" data-tab="tab5" onclick="loadTab('tab5')">탭5</button>
            </div>
        </div>
    </nav>

    <!-- 로그인 모달 -->
    <div id="loginModal" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); align-items: center; justify-content: center;">
        <div style="background-color: white; padding: 2rem; border-radius: 8px; max-width: 400px; width: 90%; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">로그인</h2>
            <p class="text-sm text-gray-600 mb-4">전화번호를 입력하세요. 전화번호가 귀하의 고유 식별자입니다.</p>
            <input type="tel" id="phoneInput" placeholder="010-0000-0000" 
                   style="width: 100%; padding: 0.5rem 1rem; border: 1px solid #D1D5DB; border-radius: 4px; margin-bottom: 1rem;">
            <div style="display: flex; gap: 0.5rem;">
                <button onclick="doLogin()" style="flex: 1; background: #0066FF; color: white; padding: 0.5rem 1rem; border-radius: 4px; border: none; cursor: pointer;">
                    확인
                </button>
                <button onclick="closeModal()" style="flex: 1; background: #D1D5DB; color: #374151; padding: 0.5rem 1rem; border-radius: 4px; border: none; cursor: pointer;">
                    취소
                </button>
            </div>
        </div>
    </div>

    <!-- 콘텐츠 영역 -->
    <div id="content-container">
        <div class="loading">콘텐츠를 불러오는 중...</div>
    </div>

    <script>
        let currentTab = 'tab1';
        let currentPage = '';

        // 페이지 로드 시 초기화
        window.addEventListener('load', function() {
            checkLoginStatus();
            
            const hash = window.location.hash.substring(1);
            if (hash.startsWith('page-')) {
                const pageName = hash.replace('page-', '');
                loadPage(pageName);
            } else {
                const tabToLoad = hash || 'tab1';
                loadTab(tabToLoad);
            }
        });

        // 탭 로드 함수
        async function loadTab(tabName) {
            currentTab = tabName;
            currentPage = '';
            
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.tab === tabName) {
                    btn.classList.add('active');
                }
            });
            
            window.location.hash = tabName;
            
            const container = document.getElementById('content-container');
            container.innerHTML = '<div class="loading">콘텐츠를 불러오는 중...</div>';
            
            try {
                const response = await fetch(`contents/${tabName}-content.html`);
                if (!response.ok) throw new Error('콘텐츠를 불러올 수 없습니다.');
                
                const html = await response.text();
                container.innerHTML = html;
                
                executeScripts(container);
            } catch (error) {
                console.error('Error loading tab:', error);
                container.innerHTML = '<div class="loading" style="color: #DC2626;">콘텐츠를 불러오는데 실패했습니다.</div>';
            }
        }

        // 페이지 로드 함수 (도청, 시청 등)
        async function loadPage(pageName) {
            currentPage = pageName;
            
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            window.location.hash = 'page-' + pageName;
            
            const container = document.getElementById('content-container');
            container.innerHTML = '<div class="loading">콘텐츠를 불러오는 중...</div>';
            
            try {
                const response = await fetch(`contents/${pageName}-content.html`);
                if (!response.ok) throw new Error('콘텐츠를 불러올 수 없습니다.');
                
                const html = await response.text();
                container.innerHTML = html;
                
                executeScripts(container);
            } catch (error) {
                console.error('Error loading page:', error);
                container.innerHTML = '<div class="loading" style="color: #DC2626;">콘텐츠를 불러오는데 실패했습니다.</div>';
            }
        }

        // 스크립트 실행 함수
        function executeScripts(container) {
            const scripts = container.querySelectorAll('script');
            scripts.forEach(script => {
                const newScript = document.createElement('script');
                if (script.src) {
                    newScript.src = script.src;
                } else {
                    newScript.textContent = script.textContent;
                }
                document.body.appendChild(newScript);
                script.remove();
            });
        }

        // 로그인 관련 함수들
        function checkLoginStatus() {
            const phoneNumber = localStorage.getItem('userPhone');
            const authBtn = document.getElementById('authBtn');
            const userInfo = document.getElementById('userInfo');
            
            if (phoneNumber) {
                authBtn.textContent = '로그아웃';
                userInfo.textContent = phoneNumber;
                userInfo.style.display = 'inline';
            } else {
                authBtn.textContent = '로그인';
                userInfo.style.display = 'none';
            }
        }

        function handleAuth() {
            const phoneNumber = localStorage.getItem('userPhone');
            
            if (phoneNumber) {
                if (confirm('로그아웃 하시겠습니까?')) {
                    localStorage.removeItem('userPhone');
                    alert('로그아웃되었습니다.');
                    checkLoginStatus();
                }
            } else {
                document.getElementById('loginModal').style.display = 'flex';
            }
        }

        function doLogin() {
            const phoneInput = document.getElementById('phoneInput');
            const phoneNumber = phoneInput.value.trim();
            
            if (!phoneNumber) {
                alert('전화번호를 입력하세요.');
                return;
            }
            
            const phoneRegex = /^[0-9-]+$/;
            if (!phoneRegex.test(phoneNumber)) {
                alert('올바른 전화번호 형식을 입력하세요.');
                return;
            }
            
            localStorage.setItem('userPhone', phoneNumber);
            alert('로그인되었습니다.');
            
            closeModal();
            checkLoginStatus();
        }

        function closeModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('phoneInput').value = '';
        }

        document.getElementById('phoneInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                doLogin();
            }
        });

        // 전역 헬퍼 함수들
        window.getUserPhone = function() {
            return localStorage.getItem('userPhone');
        };

        window.requireLogin = function() {
            const phone = getUserPhone();
            if (!phone) {
                alert('로그인이 필요합니다.');
                handleAuth();
                return false;
            }
            return true;
        };

        // 전역 네비게이션 함수
        window.navigateToPage = loadPage;
        window.navigateToTab = loadTab;
    </script>
</body>
</html>
